Для проверки качества семантического поиска (RAG) по подготовленному стандарту, я разбил тест-кейсы на категории: от простого поиска фактов до сложных логических связок и обработки синонимов.

Это поможет оценить, насколько хорошо система понимает **интент** (намерение) пользователя, а не просто ищет ключевые слова.

### 1. Тестирование синонимов и сленга (Paraphrasing)
*Цель: Проверить, находит ли модель информацию, если пользователь использует неформальную лексику, отсутствующую в документе.*

| ID | Запрос пользователя | Ожидаемый релевантный раздел / Чанк | Почему это важный тест |
|:---|:---|:---|:---|
| **P-01** | «Флешка заблочилась, что делать?» | **Раздел 1 (Rutoken)**: Симптом «Статус... Blocked» → Звонить в поддержку. | В тексте нет слова «флешка» (есть USB-токен), но семантически это одно и то же. |
| **P-02** | «Не работает видео в Дионе» | **Раздел 5 (Сфера)**: Сетевые исключения (Dion/Video). | Пользователь описывает проблему («не работает»), а документ содержит решение (список хостов). |
| **P-03** | «Как попасть на удаленку?» | **Раздел 2 (Region)** или **7 (Глоссарий)**: ВРМ — Виртуальное Рабочее Место. | «Удаленка» — частый синоним для ВРМ/VDI. |
| **P-04** | «Комп висит» | **Раздел 2 (Region)**: Симптом «Завис рабочий стол ВРМ» → Restart. | Проверка связи сленга («висит») с термином («завис»). |

---

### 2. Тестирование причинно-следственных связей (Causality)
*Цель: Проверить, может ли система объяснить причину проблемы («Почему?») или предсказать последствие («Что будет, если?»).*

| ID | Запрос пользователя | Ожидаемый релевантный раздел / Чанк | Почему это важный тест |
|:---|:---|:---|:---|
| **C-01** | «Почему меня заблокировали в девкорпе?» | **Раздел 3 (DevCorp)**: ⚠️ Ограничение / Последствие нарушения. | Поиск причины (отсутствие Сакуры) по следствию (блокировка). |
| **C-02** | «Зачем нужна виртуалка?» | **Раздел 3 (DevCorp)**: ⚠️ Ограничение / Причина: Требования ИБ. | Проверка понимания обоснования требований. |
| **C-03** | «Что будет, если я поставлю DLP на свой ноутбук?» | **Раздел 3 (DevCorp)**: ❌ Не допускается / Установка антивируса... на хост. | Тест на поиск анти-паттернов (запрещенных действий). |
| **C-04** | «Сакура ругается на связь с сервером» | **Раздел 6 (Troubleshooting)**: Симптом «Нет связи с сервером» → Решение. | Связь ошибки приложения с состоянием сети (VPN). |

---

### 3. Тестирование точного поиска сущностей (NER / Fact Retrieval)
*Цель: Проверить, не «галлюцинирует» ли модель цифры, адреса и контакты.*

| ID | Запрос пользователя | Ожидаемый релевантный раздел / Чанк | Почему это важный тест |
|:---|:---|:---|:---|
| **F-01** | «Какой адрес у шлюза для разработки?» | **Раздел 3 (DevCorp)**: `ext.vpn.vtb.ru`. | Важно не перепутать с `cvpn.vtb.ru` (Region). |
| **F-02** | «Номер телефона поддержки Иннотеха» | **Раздел 6 (Контакты)**: `8 800 500 33 33`. | Точное извлечение цифровой последовательности. |
| **F-03** | «Какой заводской пароль на токене?» | **Раздел 1 (Rutoken)**: `1234567890`. | Поиск специфического значения. |
| **F-04** | «Кому писать по проблемам с DLP?» | **Раздел 6 (Контакты)**: `security@phoenixit.ru`. | Различение внешней (ВТБ) и внутренней (PhoenixIT) поддержки. |

---

### 4. Тестирование процедурных знаний (How-to)
*Цель: Проверить способность модели собрать пошаговую инструкцию.*

| ID | Запрос пользователя | Ожидаемый релевантный раздел / Чанк | Почему это важный тест |
|:---|:---|:---|:---|
| **H-01** | «Как настроить аутлук?» | **Раздел 2 (Region)**: Симптом → Решение (про ввод `REGION\VTB`). | Инструкция может быть скрыта в разделе Troubleshooting. |
| **H-02** | «Продление учетки Иннотех» | **Раздел 4 (Т1/Иннотех)**: Изменение процесса (автоматически). | Модель должна сказать, что *делать ничего не надо* (важный кейс изменения бизнес-процесса). |
| **H-03** | «Порядок установки ПО на виртуалку» | **Раздел 3 (DevCorp)**: Процедура настройки (KES → DLP → Сакура). | Проверка строгого порядка действий (Order sensitivity). |

---

### 5. Негативные тесты и Disambiguation (Устранение неоднозначности)
*Цель: Проверить, не путает ли модель похожие понятия (разные VPN, разные поддержки).*

| ID | Запрос пользователя | Ожидаемый релевантный раздел / Чанк | Почему это важный тест |
|:---|:---|:---|:---|
| **N-01** | «Настройки VPN» | **Разделы 2, 3 и 4**. | Запрос слишком широкий. Хороший RAG должен спросить: «Какой VPN? Region, Ext или Иннотех?». |
| **N-02** | «Я забыл пароль» | **Разделы 3 и 4**. | Неоднозначность. Пароль от DevCorp сбрасывается через `spp3`, Иннотех — через сайт/телефон. |
| **N-03** | «Можно отправить письмо на яндекс почту?» | **Раздел 2 (Region)**: ❌ Не допускается / Отправка... на внешние адреса. | Проверка запрета (Negative constraint). |

---

### Метрики для оценки (как оценивать результаты):

1.  **Hit Rate (Recall):** Был ли правильный чанк (раздел) найден в топ-3 результатах поиска?
2.  **Answer Relevance:** Ответил ли бот на вопрос, используя найденный контекст, или начал лить воду?
    *   *Пример:* На вопрос «Как продлить Иннотех» плохой ответ: «Обратитесь в поддержку». Хороший ответ: «Продление происходит автоматически, заявка не требуется».
3.  **Faithfulness (Точность):** Не выдумал ли бот несуществующий телефон или адрес, смешав цифры из разных разделов?